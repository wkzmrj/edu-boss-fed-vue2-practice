"use strict";(self["webpackChunkedu_boss_fed_vue2"]=self["webpackChunkedu_boss_fed_vue2"]||[]).push([[378],{1722:function(e,t,a){a.r(t),a.d(t,{default:function(){return g}});var r=function(){var e=this,t=e._self._c;return t("div",{staticClass:"user"},[t("user-list")],1)},s=[],l=function(){var e=this,t=e._self._c;return t("el-card",[t("div",{attrs:{slot:"header"},slot:"header"},[t("el-form",{ref:"filter-form",attrs:{inline:!0,model:e.filterParams}},[t("el-form-item",{attrs:{label:"手机号",prop:"phone"}},[t("el-input",{model:{value:e.filterParams.phone,callback:function(t){e.$set(e.filterParams,"phone",t)},expression:"filterParams.phone"}})],1),t("el-form-item",{attrs:{label:"注册时间",prop:"rangeDate"}},[t("el-date-picker",{attrs:{type:"datetimerange","range-separator":"至","start-placeholder":"开始时间","end-placeholder":"结束时间","value-format":"yyyy-MM-dd"},model:{value:e.filterParams.rangeDate,callback:function(t){e.$set(e.filterParams,"rangeDate",t)},expression:"filterParams.rangeDate"}})],1),t("el-form-item",[t("el-button",{attrs:{disabled:e.isLoading},on:{click:e.handleReset}},[e._v("重置")]),t("el-button",{attrs:{type:"primary",disabled:e.isLoading},on:{click:e.handleQuery}},[e._v("查询")])],1)],1)],1),t("el-table",{directives:[{name:"loading",rawName:"v-loading",value:e.isLoading,expression:"isLoading"}],staticStyle:{width:"100%"},attrs:{data:e.users}},[t("el-table-column",{attrs:{prop:"id",label:"用户ID",width:"150"}}),t("el-table-column",{attrs:{prop:"name",label:"头像",width:"100"},scopedSlots:e._u([{key:"default",fn:function(e){return[t("img",{attrs:{width:"30px",src:e.row.portrait||"https://cube.elemecdn.com/9/c2/f0ee8a3c7c9638a54940382568c9dpng.png"}})]}}])}),t("el-table-column",{attrs:{prop:"name",label:"用户名"}}),t("el-table-column",{attrs:{prop:"phone",label:"手机号"}}),t("el-table-column",{attrs:{prop:"createTime",label:"注册时间"}}),t("el-table-column",{attrs:{prop:"name",label:"状态",width:"80"},scopedSlots:e._u([{key:"default",fn:function(a){return[t("el-switch",{attrs:{"active-value":"ENABLE","inactive-value":"DISABLE","active-color":"#13ce66","inactive-color":"#ff4949"},on:{change:function(t){return e.handleForbidUser(a.row)}},model:{value:a.row.status,callback:function(t){e.$set(a.row,"status",t)},expression:"scope.row.status"}})]}}])}),t("el-table-column",{attrs:{prop:"address",label:"操作"},scopedSlots:e._u([{key:"default",fn:function(a){return[t("el-button",{attrs:{type:"text"},on:{click:function(t){return e.handleSelectRole(a.row)}}},[e._v("分配角色")])]}}])})],1),t("el-dialog",{attrs:{title:"分配角色",visible:e.dialogVisible,width:"50%"},on:{"update:visible":function(t){e.dialogVisible=t}}},[t("el-select",{attrs:{multiple:"",placeholder:"请选择"},model:{value:e.roleIdList,callback:function(t){e.roleIdList=t},expression:"roleIdList"}},e._l(e.roles,(function(e){return t("el-option",{key:e.value,attrs:{label:e.name,value:e.id}})})),1),t("span",{staticClass:"dialog-footer",attrs:{slot:"footer"},slot:"footer"},[t("el-button",{on:{click:function(t){e.dialogVisible=!1}}},[e._v("取 消")]),t("el-button",{attrs:{type:"primary"},on:{click:e.handleAllocRole}},[e._v("确 定")])],1)],1)],1)},o=[],n=a(3099),i=a(2854),d={name:"UserList",data(){return{users:[],filterParams:{currentPage:1,pageSize:100,phone:"",startCreateTime:"",endCreateTime:"",rangeDate:[]},isLoading:!0,dialogVisible:!1,roles:[],roleIdList:[],currentRoleID:null}},created(){this.loadUsers()},methods:{async handleAllocRole(){const{data:e}=await(0,i.uD)({userId:this.currentRoleID,roleIdList:this.roleIdList});"000000"===e.code&&(this.$message.success("分配角色成功"),this.dialogVisible=!1)},async loadUsers(){this.isLoading=!0;const{rangeDate:e}=this.filterParams;e&&e.length?(this.filterParams.startCreateTime=e[0],this.filterParams.endCreateTime=e[1]):(this.filterParams.startCreateTime="",this.filterParams.endCreateTime="");const{data:t}=await(0,n.h5)(this.filterParams);this.users=t.data.records,this.isLoading=!1},async handleForbidUser(e){const{data:t}=await(0,n.N8)(e.id);console.log(t)},handleQuery(){this.filterParams.currentPage=1,this.loadUsers()},handleReset(){this.$refs["filter-form"].resetFields(),this.loadUsers()},async handleSelectRole(e){this.currentRoleID=e.id,this.dialogVisible=!0;const{data:t}=await(0,i.xJ)();"000000"===t.code&&(this.roles=t.data);const{data:a}=await(0,i.Jm)(e.id);"000000"===a.code&&(this.roleIdList=a.data.map((e=>e.id)))}}},u=d,c=a(1001),f=(0,c.Z)(u,l,o,!1,null,"3554fc1a",null),m=f.exports,h={name:"UserIndex",components:{UserList:m}},p=h,b=(0,c.Z)(p,r,s,!1,null,"1a8a81e4",null),g=b.exports},2854:function(e,t,a){a.d(t,{F3:function(){return s},Jm:function(){return u},Rd:function(){return l},T9:function(){return o},uD:function(){return d},xJ:function(){return i},xQ:function(){return n}});var r=a(3139);const s=e=>(0,r.Z)({method:"POST",url:"/boss/role/getRolePages",data:e}),l=e=>(0,r.Z)({method:"DELETE",url:`/boss/role/${e}`}),o=e=>(0,r.Z)({method:"POST",url:"/boss/role/saveOrUpdate",data:e}),n=e=>(0,r.Z)({method:"GET",url:`/boss/role/${e}`}),i=()=>(0,r.Z)({method:"GET",url:"/boss/role/all"}),d=e=>(0,r.Z)({method:"POST",url:"/boss/role/allocateUserRoles",data:e}),u=e=>(0,r.Z)({method:"GET",url:`/boss/role/user/${e}`})},3099:function(e,t,a){a.d(t,{N8:function(){return d},bG:function(){return n},h5:function(){return i},x4:function(){return o}});var r=a(3139),s=a(129),l=a.n(s);const o=e=>(0,r.Z)({method:"POST",url:"/front/user/login",data:l().stringify(e)}),n=()=>(0,r.Z)({method:"GET",url:"/front/user/getInfo"}),i=e=>(0,r.Z)({method:"POST",url:"/boss/user/getUserPages",data:e}),d=e=>(0,r.Z)({method:"POST",url:"/boss/user/forbidUser",params:{userId:e}})}}]);
//# sourceMappingURL=user.56ae3c7c.js.map